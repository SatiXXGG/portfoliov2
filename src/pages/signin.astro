---
import NavBar from "../components/nav-bar.astro";
import Layout from "../layouts/Layout.astro";
import Cat from "../components/cat.astro";
---

<Layout title="Sign In">
  <NavBar />
  <main class="flex flex-col items-center">
    <Cat>Sign In</Cat>

    <button
      class="w-72 bg-black font-bold text-white rounded-2xl h-9 mt-3 transition-all hover:scale-105 duration-200"
      id="register-done">Sign in with GOOGLE</button
    >

    <script>
      import { initializeApp } from "firebase/app";
      import {
        getAuth,
        GoogleAuthProvider,
        signInWithPopup,
      } from "firebase/auth";

      const firebaseConfig = {
        apiKey: "AIzaSyA8QmYfTC6v5T1UZpqxarSExNWXZ9ahKDA",
        authDomain: "portfolio-7a5f5.firebaseapp.com",
        projectId: "portfolio-7a5f5",
        storageBucket: "portfolio-7a5f5.appspot.com",
        messagingSenderId: "198869603584",
        appId: "1:198869603584:web:85d2b2c5091f28737e4fe5",
        measurementId: "G-PQWQB1D72S",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const provider = new GoogleAuthProvider();

      let button = document.querySelector("#register-done");
      button.addEventListener("click", (e) => {
        const result = signInWithPopup(auth, provider);
        console.log(result);
      });
    </script>

    <script>
      import { initializeApp } from "firebase/app";
      import { onAuthStateChanged } from "firebase/auth";
      import { getAuth } from "firebase/auth";
      const firebaseConfig = {
        apiKey: "AIzaSyA8QmYfTC6v5T1UZpqxarSExNWXZ9ahKDA",
        authDomain: "portfolio-7a5f5.firebaseapp.com",
        projectId: "portfolio-7a5f5",
        storageBucket: "portfolio-7a5f5.appspot.com",
        messagingSenderId: "198869603584",
        appId: "1:198869603584:web:85d2b2c5091f28737e4fe5",
        measurementId: "G-PQWQB1D72S",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      let imageElement = document.getElementById("userImg");
      let logOut = document.getElementById("logOut");
      onAuthStateChanged(auth, (user) => {
        if (user) {
          imageElement.src = user.photoURL;
          logOut.visibility = "visible";
        } else {
          console.log("out");
          logOut.visibility = "hidden";
        }
      });
    </script>
  </main>
</Layout>

<style is:global>
  body {
    font-family:
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      Oxygen,
      Ubuntu,
      Cantarell,
      "Open Sans",
      "Helvetica Neue",
      sans-serif;

    background-color: rgb(33, 33, 33);
  }
</style>
